<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mini Profiles — Auroreine (Magazine)</title>

<style>
/* Magazine-themed redesign: typographic, spacious, editorial layout */
@font-face{font-family:"Bodoni XT";src:url('/fonts/BodoniXT.woff2') format('woff2'),url('/fonts/BodoniXT.woff') format('woff');font-weight:600;font-style:normal;font-display:swap}
@font-face{font-family:"Cinzel";src:url('/fonts/Cinzel-Regular.woff2') format('woff2'),url('/fonts/Cinzel-Regular.woff') format('woff');font-weight:700;font-style:normal;font-display:swap}
@font-face{font-family:"Quenda";src:url('/fonts/Quenda-Medium.woff2') format('woff2'),url('/fonts/Quenda-Medium.woff') format('woff');font-weight:500;font-style:normal;font-display:swap}
:root{--bg:#faf7ff;--panel:#fff;--muted:#6f6a78;--ink:#101018;--accent:#8a5cff;--soft:#b7b0ca;--max-width:980px}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:linear-gradient(180deg,#fff,#f7f3fb);color:var(--ink);font-family:Quenda,system-ui,Arial;display:flex;justify-content:center;padding:28px}
.container{width:100%;max-width:var(--max-width)}
.header{display:flex;align-items:flex-end;gap:20px;padding:24px 0;border-bottom:1px solid rgba(16,14,22,0.04)}
.masthead{font-family:"Bodoni XT","Cinzel",serif;color:var(--accent);font-size:44px;line-height:1;letter-spacing:0.02em}
.kicker{font-size:12px;color:var(--soft);text-transform:uppercase;letter-spacing:0.18em}
.layout{display:grid;grid-template-columns:1fr 340px;gap:28px;margin-top:20px}
.card{background:var(--panel);border-radius:12px;padding:26px;box-shadow:0 20px 40px rgba(16,14,22,0.06);}
.article-hero{display:flex;gap:24px;align-items:flex-start}
.profile-media{flex:0 0 220px;height:220px;border-radius:8px;background:linear-gradient(180deg,#efeaf8,#f8f6ff);display:flex;align-items:center;justify-content:center;font-family:"Cinzel",serif;color:var(--soft);font-size:13px}
.profile-meta{flex:1}
.profile-title{font-family:"Cinzel",serif;font-size:28px;margin:0;color:var(--ink);letter-spacing:0.6px}
.profile-sub{color:var(--muted);margin-top:6px;margin-bottom:12px}
.profile-blurb{font-size:16px;line-height:1.7;color:#322f3a;margin:0}
.controls{display:flex;gap:12px;margin-top:18px}
button.primary{background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:999px;font-weight:700;cursor:pointer;box-shadow:0 8px 22px rgba(138,92,255,0.12)}
button.ghost{background:transparent;color:var(--muted);border:1px solid rgba(16,14,22,0.06);padding:10px 14px;border-radius:999px;cursor:pointer}
.fav-icon{width:18px;height:18px;margin-right:8px}
.helper{font-size:12px;color:var(--soft);margin-top:10px}

/* Sidebar as editorial column */
.sidebar{position:relative}
.side-panel{background:linear-gradient(180deg,#fff,#fbfaff);padding:18px;border-radius:10px;border:1px solid rgba(16,14,22,0.03)}
.tabs{display:flex;gap:8px;margin-bottom:12px}
.tab{flex:1;padding:8px 10px;border-radius:8px;font-size:13px;text-align:center;color:var(--muted);background:transparent;border:1px solid transparent;cursor:pointer}
.tab.active{background:rgba(138,92,255,0.08);color:var(--accent);border-color:rgba(138,92,255,0.12)}
#tab-news{flex:0 0 56px;padding:6px;display:flex;align-items:center;justify-content:center}
#tab-news img{width:22px;height:22px;display:block}

.small-card{margin-bottom:12px;padding:12px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfaff);border:1px solid rgba(16,14,22,0.03)}
.small-card h4{margin:0;font-size:14px;color:var(--ink)}
.small-card p{margin:8px 0 0;color:var(--muted);font-size:13px}

.news-modal-backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(16,14,22,0.45);z-index:10020;padding:20px}
.news-modal-backdrop.open{display:flex}
.news-modal{width:min(780px,calc(100% - 40px));background:var(--panel);border-radius:10px;padding:18px}
.news-title-main{font-weight:700;font-size:16px}
.news-list{display:flex;flex-direction:column;gap:10px;margin-top:8px}
.news-item{display:flex;gap:12px;align-items:flex-start;padding:10px;border-radius:8px;border:1px solid rgba(16,14,22,0.03)}
.news-thumb{width:76px;height:60px;border-radius:6px;background:#eee;object-fit:cover}
.news-meta{flex:1}
.news-excerpt{color:var(--muted);font-size:14px;margin:0}
.news-open-tele{font-size:13px;color:var(--accent);text-decoration:none}

/* Responsive */
@media (max-width:920px){.layout{grid-template-columns:1fr}.masthead{font-size:36px}.profile-media{flex-basis:160px;height:160px}}
@media (max-width:520px){body{padding:16px}.masthead{font-size:28px}.layout{gap:16px}}

</style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div>
        <div class="kicker">atelier notes</div>
        <div class="masthead">Auroreine</div>
      </div>
      <div style="margin-left:auto;text-align:right">
        <div style="font-size:13px;color:var(--muted)">Mini Profiles — Edition</div>
        <div style="font-size:12px;color:var(--soft);margin-top:6px">Curated · Magazine-style</div>
      </div>
    </header>

    <main class="layout">
      <section class="card article">
        <div class="article-hero">
          <div class="profile-media" id="profileMedia">Zhou Xinyu</div>
          <div class="profile-meta">
            <h2 class="profile-title" id="profile-title">Zhou Xinyu</h2>
            <div class="profile-sub" id="profile-tag">Muse · TripleS</div>
            <p class="profile-blurb" id="profile-text">Soft-spoken, stage-light kind of pretty. Carries winter glow and slow-day calm, like a quiet verse written in silver.</p>

            <div class="controls">
              <button class="primary" id="favBtn" aria-pressed="false" title="Favorite"><img src="./classy_purple_fox_50px_smooth.gif" class="fav-icon" alt="fox"> Favor</button>
              <button class="ghost" id="playBtn" aria-pressed="false" title="Play preview">▶ Play</button>
            </div>
            <div class="helper">Your choice will be sent back to the bot as a tiny note.</div>

            <article style="margin-top:20px;font-size:15px;color:#3a3340;line-height:1.8">
              <h3 style="margin:0 0 8px;font-family:'Cinzel',serif;color:var(--accent)">About the Muse</h3>
              <p style="margin:0">This profile is presented in a magazine layout — roomy margins, typographic scale, and editorial rhythm. It preserves all interactive features (favorite, audio, news) while presenting them in an editorial column.</p>
            </article>
          </div>
        </div>
      </section>

      <aside class="sidebar">
        <div class="side-panel">
          <div class="tabs" id="tabs">
            <button class="tab small active" id="tab-zhou">Muse</button>
            <button class="tab small" id="tab-rp">Another</button>
            <button id="tab-news" class="tab" title="Latest news" aria-label="Latest news"><img id="newsSymbol" src="./newss.png" alt="news"></button>
          </div>

          <div class="small-card">
            <h4>Now</h4>
            <p id="nowStatus" style="margin:6px 0 0;color:var(--muted);font-size:13px">Listening: playsongnew.mp3 · Favorite status saved locally</p>
          </div>

          <div class="small-card">
            <h4>About</h4>
            <p>Meredith Melrose · S15 — night-coded. Click the tabs to switch profiles; use the news icon to open latest posts.</p>
          </div>

          <div class="small-card">
            <h4>Quick Links</h4>
            <p style="margin-top:8px"><a href="https://t.me/S15XINYU" class="news-open-tele" target="_blank" rel="noopener noreferrer">Open channel in Telegram</a></p>
          </div>
        </div>
      </aside>
    </main>

    <!-- NEWS modal -->
    <div class="news-modal-backdrop" id="newsBackdrop" aria-hidden="true">
      <div class="news-modal" role="dialog" aria-modal="true" aria-labelledby="newsTitle">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div id="newsTitle" class="news-title-main">Recent dispatches</div>
            <div class="news-sub" style="display:none">Newest at top — click to open a post</div>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="news-close" id="newsClose">Close</button>
            <a class="news-open-tele small-link" id="newsOpenChannel" target="_blank" rel="noopener noreferrer" href="https://t.me/S15XINYU">Open in Telegram</a>
          </div>
        </div>
        <div id="newsContent"><div class="news-list"><div class="news-empty">Loading latest posts…</div></div></div>
      </div>
    </div>

  </div>

  <!-- keep original audio elements and ids so JS continues to work -->
  <audio id="profileAudio" preload="auto"><source src="playsongnew.mp3" type="audio/mpeg"></audio>
  <audio id="doorAudio" preload="auto"><source src="door_open.mp3" type="audio/mpeg"></audio>

<script>
// preserve original JS behavior where possible — reuse element IDs
const tZ = document.getElementById('tab-zhou');
const tR = document.getElementById('tab-rp');
const tNews = document.getElementById('tab-news');
const profileAudio = document.getElementById('profileAudio');
const favBtn = document.getElementById('favBtn');
const playBtn = document.getElementById('playBtn');
const newsBackdrop = document.getElementById('newsBackdrop');
const newsContent = document.getElementById('newsContent');
const newsClose = document.getElementById('newsClose');
const newsOpenChannel = document.getElementById('newsOpenChannel');

const profiles = {
  zhou: { title: 'Zhou Xinyu', tag: 'Muse · TripleS', text: 'Soft-spoken, stage-light kind of pretty.\nCarries winter glow and slow-day calm,\nlike a quiet verse written in silver.' },
  rp: { title: 'Meredith Melrose', tag: 'S15 · night-coded', text: 'Writes in lowercase and starlight.\nHalf diary, half song, always a little\nlate to leave the dream.' }
};
let selected = 'zhou';

function setActive(k){ selected = k; const d = profiles[k]; document.getElementById('profile-title').textContent = d.title; document.getElementById('profile-tag').textContent = d.tag; document.getElementById('profile-text').textContent = d.text; // keep tabs active
  [tZ,tR,tNews].forEach(el=> el && el.classList.remove('active')); if(k==='zhou') tZ.classList.add('active'); else if(k==='rp') tR.classList.add('active'); }
if (tZ) tZ.addEventListener('click', ()=> setActive('zhou'));
if (tR) tR.addEventListener('click', ()=> setActive('rp'));

// favorite (localStorage)
const STORAGE_KEY = 'miniapp_favs_v1';
function loadFavs(){ try{const raw=localStorage.getItem(STORAGE_KEY);return raw?JSON.parse(raw):{} }catch(e){return{}} }
function saveFavs(o){ try{localStorage.setItem(STORAGE_KEY,JSON.stringify(o)) }catch(e){} }
function updateFavUI(){ const favs = loadFavs(); const isFav = !!favs[selected]; favBtn.setAttribute('aria-pressed', isFav); favBtn.textContent = isFav ? 'Favorited' : 'Favor'; }
favBtn.addEventListener('click', ()=>{ const favs = loadFavs(); const cur = !!favs[selected]; if(cur) delete favs[selected]; else favs[selected]={ts:Date.now()}; saveFavs(favs); updateFavUI(); // send to telegram if available
  if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.sendData) try{ window.Telegram.WebApp.sendData(JSON.stringify({type:'fav',profile:selected,fav:!cur})) }catch(e){} });
updateFavUI();

// audio
const PROFILE_AUDIO_MAP = { zhou: 'playsongnew.mp3', rp: 'playsongnew.mp3' };
function currentProfileAudioFile(){ return PROFILE_AUDIO_MAP[selected]||'playsongnew.mp3' }
if(playBtn){ playBtn.addEventListener('click', async ()=>{
  if(!profileAudio){ alert('Audio not available. Tambahkan playsongnew.mp3 di folder yang sama dengan file ini.'); return }
  const desired = currentProfileAudioFile(); const currentSource = profileAudio.querySelector('source')?.getAttribute('src')||''; if(currentSource!==desired){ profileAudio.innerHTML = `<source src="${desired}" type="audio/mpeg">`; try{profileAudio.load()}catch(e){} }
  try{ if(profileAudio.paused){ await profileAudio.play(); playBtn.textContent='⏸ Pause'; playBtn.setAttribute('aria-pressed','true') }else{ profileAudio.pause(); playBtn.textContent='▶ Play'; playBtn.setAttribute('aria-pressed','false') } }catch(err){ playBtn.textContent='▶ Play'; alert('Gagal memutar audio — cek file playsongnew.mp3') }
}) }

// news modal (simple fallback to t.me)
const NEWS_CHANNEL = 'S15XINYU'; const NEWS_S_URL = `https://t.me/s/${NEWS_CHANNEL}`;
function openNewsModal(){ newsBackdrop.classList.add('open'); newsBackdrop.setAttribute('aria-hidden','false'); newsContent.innerHTML = '<div class="news-list"><div class="news-empty">Loading latest posts…</div></div>'; }
function closeNewsModal(){ newsBackdrop.classList.remove('open'); newsBackdrop.setAttribute('aria-hidden','true'); }
if(tNews) tNews.addEventListener('click', ()=>{ openNewsModal(); tNews.classList.add('active') }); if(newsClose) newsClose.addEventListener('click', closeNewsModal); newsBackdrop.addEventListener('click', (ev)=>{ if(ev.target===newsBackdrop) closeNewsModal() }); newsOpenChannel.href = NEWS_S_URL;

// ESC to close
document.addEventListener('keydown',(e)=>{ if(e.key==='Escape' && newsBackdrop.classList.contains('open')) closeNewsModal() });

</script>
</body>
</html>
